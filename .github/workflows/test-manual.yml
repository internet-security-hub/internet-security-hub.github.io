name: Test Manual Update
on:
  workflow_dispatch:

jobs:
  test:
    runs-on: ubuntu-latest
    permissions:
      contents: write
    steps:
      - uses: actions/checkout@v4
        
      - name: Simple test update
        run: |
          MOSCOW_DATE=$(TZ=Europe/Moscow date +"%Y-%m-%d")
          MOSCOW_TIME=$(TZ=Europe/Moscow date +"%Y-%m-%d %H:%M MSK")
          
          echo "–¢–µ—Å—Ç–∏—Ä—É–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞: $MOSCOW_DATE"
          
          # –ü—Ä–æ—Å—Ç–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
          if [ -f "index.html" ]; then
            sed -i 's/<meta property="article:modified_time" content="[^"]*"/<meta property="article:modified_time" content="'"$MOSCOW_DATE"'T01:00:00+03:00"/g' index.html
            echo "<!-- Test update: $MOSCOW_TIME -->" >> index.html
          fi
          
          # –ö–æ–º–º–∏—Ç
          git config --global user.email "test@example.com"
          git config --global user.name "Test Bot"
          git add -A
          git commit -m "üß™ –¢–µ—Å—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è: $MOSCOW_TIME"
          git push
